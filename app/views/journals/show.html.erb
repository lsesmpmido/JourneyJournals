<div class="container">
  <div class="main-content">
    <h1><%= t('views.common.title_show', name: Journal.model_name.human) %></h1>
    <div class="btn">
      <%= link_to t('views.common.edit', name: Journal.model_name.human.downcase), edit_journal_path(@journal) %>
    </div>

    <h2><%= @journal.journal_name %></h2>
    <div class="frame">
      <%= @journal.description.presence || t('views.common.no_data', name: Journal.human_attribute_name(:description)) %>
    </div>

    <h2><%= t('views.journal.activity_record') %></h2>
    <div class="frame">
      <% @grouped_images.each do |date, images| %>
        <% if images.present? %>
          <h3><%= date %></h3>
        <% end %>
        <ul class="activity_record">
          <% images.each do |image| %>
            <li class="frame sub-frame">
              <%= link_to image_path(image) do %><%= image.image_name %><% end %><br>
              <% if image.date_of_shooting %>
                <strong><%= t(Image.human_attribute_name(:date_of_shooting)) %>:</strong>
                <%= image.date_of_shooting.in_time_zone('Asia/Tokyo').strftime("%H時%M分") %>
              <% end %>
              <% if image.latitude && image.longitude %>
                <strong><%= t('views.image.location_of_shooting') %>:</strong>
                <%= "(#{image.latitude}, #{image.longitude})" %>
              <% end %>
            </li>
          <% end %>
        </ul>
      <% end %>

      <div class="map">
        <% if @locations %>
          <div id="map" style="width: 400px; height: 400px;" data-locations="<%= @locations.to_json %>"></div>
          <% content_for :scripts do %>
            <%= javascript_include_tag "journals/show_route_map" %>
          <% end %>
        <% end %>
      </div>
    </div>

    <h2><%= Comment.model_name.human %></h2>
    <div class="frame">
      <%= render 'comments/form', commentable: @journal, comment: @comment %>
      <div>
        <%= render 'comments/comments', commentable: @journal, comments: @comments %>
      </div>
    </div>

  </div>

  <div class="side-content">
    <h2><%= Image.model_name.human %></h2>
    <div id="new-image-path">
      <div class="btn">
        <%= link_to t('views.common.new', name: Image.model_name.human.downcase), new_journal_image_path(@journal) %>
      </div>
    </div>
    <ul>
      <% @images.each do |image| %>
        <%= link_to image_path(image) do %>
          <%= image_tag image.file, alt: image.image_name, class: "fixed-height-image", loading: "lazy" %>
        <% end %>
        <br>
      <% end %>
    </ul>
  </div>
</div>
